server {
	listen 8080;
	server_name vagrant;

	root /srv/photosf/app/webroot/;
	index index.php;

	access_log /var/log/photosf.ca/access.log;
	error_log /var/log/photosf.ca/error.log;

	location / {
		try_files $uri $uri/ =404;

		client_body_temp_path      	/tmp/;
        client_body_in_file_only   	on;
        client_body_buffer_size    	1000M;
        client_max_body_size 		1000M;
        fastcgi_read_timeout 		30000;

 		if (-f $request_filename) {
 			break;
		}
		if (!-f $request_filename) {
 			rewrite ^/(.+)$ /index.php?url=$1 last;
			break;
		}
	}

	location ~ \.php$ {
		include snippets/fastcgi-php.conf;
		fastcgi_pass unix:/run/php/php5.6-fpm.sock;
		fastcgi_read_timeout 1h;
	}

	location ~ /\.ht {
		deny all;
	}
}
